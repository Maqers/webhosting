/**
 * ANDROID SCROLLING FIXES
 * 
 * Critical fixes for Android device scrolling issues
 * - Enables proper touch scrolling on Android browsers
 * - Fixes touch-action properties
 * - Removes user-select restrictions that block scrolling
 * - Ensures overflow properties allow scrolling
 */

/* ============================================================================
   ANDROID TOUCH SCROLLING - CRITICAL FIX
   ============================================================================ */

/* Detect Android devices (not iOS) */
@media (max-width: 767px) {
  /* Android browsers need explicit touch-action for scrolling */
  html,
  body {
    /* Allow vertical scrolling on Android */
    touch-action: pan-y !important;
    -ms-touch-action: pan-y !important;
    /* Ensure overflow allows scrolling */
    overflow-y: auto !important;
    overflow-x: hidden !important;
    /* Prevent position:fixed from breaking scroll */
    position: relative !important;
    height: auto !important;
    min-height: 100vh !important;
  }

  /* Root containers must allow scrolling */
  #root,
  .App {
    touch-action: pan-y !important;
    -ms-touch-action: pan-y !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
    position: relative !important;
    height: auto !important;
    min-height: 100vh !important;
  }

  /* All scrollable containers */
  .home,
  .products-page,
  .about-us,
  .contact-page,
  .faqs-page,
  .categories-page,
  .product-detail,
  .container,
  section,
  .section {
    touch-action: pan-y !important;
    -ms-touch-action: pan-y !important;
    overflow-y: visible !important;
    overflow-x: hidden !important;
    position: relative !important;
  }

  /* Scrollable content areas */
  .products-content,
  .product-detail-content,
  .about-content,
  .contact-content,
  .faqs-content,
  .categories-content {
    touch-action: pan-y !important;
    -ms-touch-action: pan-y !important;
    overflow-y: visible !important;
    overflow-x: hidden !important;
  }
}

/* ============================================================================
   REMOVE USER-SELECT RESTRICTIONS FOR ANDROID
   ============================================================================ */

/* Android browsers need elements to be selectable for proper touch scrolling */
/* Only apply user-select: none to iOS devices */
@media (max-width: 767px) {
  /* Override global user-select: none for Android */
  /* Allow default selection behavior on Android for scrolling */
  * {
    /* Remove restrictive user-select on Android */
    -webkit-user-select: auto !important;
    -moz-user-select: auto !important;
    -ms-user-select: auto !important;
    user-select: auto !important;
  }

  /* Keep user-select: none only for interactive elements */
  button,
  .navbar-toggle,
  .whatsapp-button,
  .indicator,
  .hero-indicators span {
    -webkit-user-select: none !important;
    -moz-user-select: none !important;
    -ms-user-select: none !important;
    user-select: none !important;
    touch-action: manipulation !important;
  }

  /* Allow text selection in content areas */
  p,
  h1, h2, h3, h4, h5, h6,
  span,
  li,
  .product-title,
  .product-description,
  .hero-title,
  .hero-subtitle {
    -webkit-user-select: text !important;
    -moz-user-select: text !important;
    -ms-user-select: text !important;
    user-select: text !important;
  }
}

/* ============================================================================
   ANDROID TOUCH-ACTION FIXES
   ============================================================================ */

@media (max-width: 767px) {
  /* Override restrictive touch-action from zoom-prevention.css */
  /* Android needs pan-y for vertical scrolling */
  html,
  body,
  #root,
  .App {
    touch-action: pan-y !important;
    -ms-touch-action: pan-y !important;
  }

  /* Allow pan gestures on all scrollable content */
  .home,
  .products-page,
  .about-us,
  .contact-page,
  .faqs-page,
  .categories-page,
  .product-detail,
  main,
  article,
  section {
    touch-action: pan-y !important;
    -ms-touch-action: pan-y !important;
  }

  /* Interactive elements can use manipulation */
  button,
  a,
  input,
  select,
  textarea {
    touch-action: manipulation !important;
    -ms-touch-action: manipulation !important;
  }

  /* Images can be zoomed */
  img {
    touch-action: pan-x pan-y pinch-zoom !important;
    -ms-touch-action: pan-x pan-y pinch-zoom !important;
  }
}

/* ============================================================================
   ANDROID OVERFLOW FIXES
   ============================================================================ */

@media (max-width: 767px) {
  /* Ensure body and html allow vertical scrolling */
  html {
    overflow-y: auto !important;
    overflow-x: hidden !important;
    height: auto !important;
    position: relative !important;
  }

  body {
    overflow-y: auto !important;
    overflow-x: hidden !important;
    height: auto !important;
    position: relative !important;
    /* Prevent fixed positioning that blocks scroll */
    position: static !important;
  }

  /* Root must allow scrolling */
  #root {
    overflow-y: auto !important;
    overflow-x: hidden !important;
    height: auto !important;
    min-height: 100vh !important;
    position: relative !important;
  }

  /* App container */
  .App {
    overflow-y: auto !important;
    overflow-x: hidden !important;
    height: auto !important;
    min-height: 100vh !important;
    position: relative !important;
  }

  /* Page containers */
  .home,
  .products-page,
  .about-us,
  .contact-page,
  .faqs-page,
  .categories-page,
  .product-detail {
    overflow-y: visible !important;
    overflow-x: hidden !important;
    position: relative !important;
    height: auto !important;
  }
}

/* ============================================================================
   ANDROID SCROLL BEHAVIOR
   ============================================================================ */

@media (max-width: 767px) {
  /* Smooth scrolling for Android */
  html {
    scroll-behavior: smooth !important;
  }

  /* Ensure scroll containers work properly */
  .category-filters,
  .sub-navbar-container,
  .products-grid {
    overflow-x: auto !important;
    overflow-y: visible !important;
    -webkit-overflow-scrolling: touch !important;
    /* Android Chrome supports -webkit-overflow-scrolling */
    touch-action: pan-x pan-y !important;
  }
}

/* ============================================================================
   PREVENT POSITION: FIXED FROM BLOCKING SCROLL ON ANDROID
   ============================================================================ */

@media (max-width: 767px) {
  /* Ensure body is never fixed when menu is closed - CRITICAL for Android */
  body:not(.menu-open):not(.sort-modal-open) {
    position: static !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
    height: auto !important;
    min-height: 100vh !important;
    touch-action: pan-y !important;
    -ms-touch-action: pan-y !important;
    /* Remove any inline styles that might block scroll */
    top: auto !important;
    left: auto !important;
    width: 100% !important;
  }

  /* Ensure html is never fixed */
  html:not(.menu-open):not(.sort-modal-open) {
    position: relative !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
    height: 100% !important;
    touch-action: pan-y !important;
    -ms-touch-action: pan-y !important;
  }

  /* Ensure root allows scrolling */
  #root:not(.menu-open-blur) {
    position: relative !important;
    overflow-y: visible !important;
    overflow-x: hidden !important;
    height: auto !important;
    min-height: 100vh !important;
    touch-action: pan-y !important;
  }
}

/* ============================================================================
   ANDROID SPECIFIC: EXCLUDE iOS FIXES
   ============================================================================ */

/* Only apply these fixes on non-iOS devices (Android) */
/* iOS uses @supports (-webkit-touch-callout: none) */
/* Android doesn't support -webkit-touch-callout, so these rules apply */

@media (max-width: 767px) {
  /* Ensure Android gets proper scrolling even if iOS fixes are loaded */
  html:not(:has(*)) {
    /* Fallback for browsers that don't support :has() */
  }

  /* Force Android scrolling fixes */
  body {
    /* Override any iOS-specific position:fixed */
    position: static !important;
  }
}

/* ============================================================================
   ANDROID CHROME SPECIFIC FIXES
   ============================================================================ */

/* Chrome on Android needs explicit height and overflow */
@media (max-width: 767px) {
  /* Ensure viewport height works on Android */
  html {
    height: 100% !important;
  }

  body {
    min-height: 100% !important;
    height: auto !important;
  }

  #root {
    min-height: 100vh !important;
    height: auto !important;
  }
}

/* ============================================================================
   TOUCH EVENT HANDLING FOR ANDROID
   ============================================================================ */

@media (max-width: 767px) {
  /* Prevent touch events from being blocked */
  * {
    /* Ensure touch events propagate */
    pointer-events: auto !important;
  }

  /* But allow manipulation on interactive elements */
  button,
  a,
  input,
  select,
  textarea {
    pointer-events: auto !important;
    touch-action: manipulation !important;
  }
}
