/**
 * iPhone CRITICAL FIXES
 * 
 * Specific fixes for iPhone users reporting issues
 * - Viewport height fixes (100vh includes address bar on iOS)
 * - Horizontal scroll prevention
 * - Touch target improvements
 * - Safe area handling
 * - Scroll behavior fixes
 */

/* ============================================================================
   iOS SAFARI VIEWPORT HEIGHT FIX - CRITICAL
   ============================================================================ */

/* iOS Safari 100vh includes address bar - use 100dvh or -webkit-fill-available */
@supports (-webkit-touch-callout: none) {
  /* iOS Safari detected */
  
  /* Fix root containers */
  #root,
  .App {
    min-height: -webkit-fill-available;
    min-height: 100dvh;
  }
  
  /* Fix page containers */
  .home,
  .products-page,
  .about-us,
  .contact-page,
  .faqs-page,
  .categories-page,
  .product-detail {
    min-height: -webkit-fill-available;
    min-height: 100dvh;
  }
  
  /* Fix hero sections */
  .hero,
  .products-hero,
  .about-hero,
  .contact-hero,
  .faqs-hero,
  .categories-hero {
    min-height: -webkit-fill-available;
    min-height: 100dvh;
  }
  
  /* Fix modals and popups */
  .modal,
  .whatsapp-popup {
    max-height: 90dvh;
    max-height: -webkit-fill-available;
  }
}

/* ============================================================================
   HORIZONTAL SCROLL PREVENTION - ENHANCED FOR iPhone
   ============================================================================ */

@media (max-width: 767px) {
  /* Force no horizontal scroll on iPhone */
  html,
  body,
  #root,
  .App {
    width: 100% !important;
    max-width: 100% !important;
    overflow-x: hidden !important;
    position: relative !important; /* DO NOT use fixed - breaks scrolling */
  }
  
  /* All containers */
  * {
    max-width: 100% !important;
    box-sizing: border-box !important;
  }
  
  /* Images */
  img {
    max-width: 100% !important;
    height: auto !important;
    display: block !important;
  }
  
  /* Tables */
  table {
    width: 100% !important;
    table-layout: auto !important;
    word-wrap: break-word !important;
  }
  
  /* Prevent any element from causing overflow */
  .container,
  .navbar-container,
  .sub-navbar-container,
  .hero-content,
  .products-content,
  .product-detail-content,
  section,
  .section {
    width: 100% !important;
    max-width: 100% !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
    padding-left: var(--spacing-md) !important;
    padding-right: var(--spacing-md) !important;
    box-sizing: border-box !important;
  }
  
  /* Products grid */
  .products-grid {
    width: 100% !important;
    max-width: 100% !important;
    padding: 0 !important;
    margin: 0 !important;
  }
  
  /* Category filters */
  .category-filters {
    width: 100% !important;
    max-width: 100% !important;
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
  }
}

/* ============================================================================
   TOUCH TARGETS - ENHANCED FOR iPhone
   ============================================================================ */

@media (max-width: 767px) {
  /* Ensure all interactive elements are touch-friendly */
  button,
  a,
  input[type="button"],
  input[type="submit"],
  .filter-chip,
  .sub-navbar-link,
  .navbar-link,
  .product-card,
  .category-card {
    min-height: 44px !important;
    min-width: 44px !important;
    padding: var(--spacing-sm) var(--spacing-md) !important;
  }
  
  /* Small buttons still need minimum size */
  button.small,
  a.small {
    min-height: 36px !important;
    min-width: 36px !important;
  }
}

/* ============================================================================
   SAFE AREA - ENHANCED FOR NOTCHED iPhones
   ============================================================================ */

@supports (padding: max(0px)) {
  /* Navbar */
  .navbar,
  .navbar-container {
    padding-left: max(var(--spacing-md), env(safe-area-inset-left)) !important;
    padding-right: max(var(--spacing-md), env(safe-area-inset-right)) !important;
    padding-top: max(0px, env(safe-area-inset-top)) !important;
  }
  
  /* Sub-navbar */
  .sub-navbar,
  .sub-navbar-container {
    padding-left: max(var(--spacing-sm), env(safe-area-inset-left)) !important;
    padding-right: max(var(--spacing-sm), env(safe-area-inset-right)) !important;
  }
  
  /* Containers */
  .container {
    padding-left: max(var(--spacing-md), env(safe-area-inset-left)) !important;
    padding-right: max(var(--spacing-md), env(safe-area-inset-right)) !important;
  }
  
  /* WhatsApp button */
  .whatsapp-container {
    bottom: max(var(--spacing-lg), env(safe-area-inset-bottom)) !important;
    right: max(var(--spacing-lg), env(safe-area-inset-right)) !important;
  }
  
  /* Footer */
  .footer {
    padding-bottom: max(var(--spacing-xl), env(safe-area-inset-bottom)) !important;
  }
  
  /* Full-width elements */
  .hero,
  .products-hero,
  .about-hero,
  .contact-hero,
  .faqs-hero {
    padding-left: env(safe-area-inset-left) !important;
    padding-right: env(safe-area-inset-right) !important;
  }
}

/* ============================================================================
   SCROLL BEHAVIOR - FIXED FOR iPhone
   ============================================================================ */

@media (max-width: 767px) {
  /* Smooth scrolling */
  html {
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
  }
  
  body {
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch;
    overscroll-behavior-y: contain; /* Prevent bounce */
  }
  
  /* Scrollable containers */
  .category-filters,
  .sub-navbar-container,
  .products-grid,
  .container {
    -webkit-overflow-scrolling: touch !important;
  }
}

/* ============================================================================
   INPUT ZOOM PREVENTION - CRITICAL FOR iPhone
   ============================================================================ */

/* iOS Safari zooms when input font size < 16px */
input[type="text"],
input[type="email"],
input[type="tel"],
input[type="number"],
input[type="search"],
input[type="password"],
input[type="url"],
textarea,
select {
  font-size: 16px !important;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
}

.search-input,
.navbar-mobile-search-section .search-input {
  font-size: 16px !important;
  min-height: 44px !important;
}

/* ============================================================================
   TEXT SIZE ADJUSTMENT - PREVENT iOS AUTO-ADJUST
   ============================================================================ */

html,
body {
  -webkit-text-size-adjust: 100% !important;
  -moz-text-size-adjust: 100% !important;
  -ms-text-size-adjust: 100% !important;
  text-size-adjust: 100% !important;
}

/* ============================================================================
   FONT RENDERING - BETTER ON iPhone
   ============================================================================ */

body,
html {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
}

/* ============================================================================
   TAP HIGHLIGHT - BETTER UX ON iPhone
   ============================================================================ */

a,
button {
  -webkit-tap-highlight-color: rgba(118, 9, 9, 0.1);
  -webkit-touch-callout: none;
}

/* ============================================================================
   STICKY POSITIONING - FIX FOR iPhone
   ============================================================================ */

@supports (-webkit-touch-callout: none) {
  .navbar,
  .sub-navbar,
  .products-filters-section {
    position: -webkit-sticky;
    position: sticky;
  }
}

/* ============================================================================
   BACKDROP FILTER - iOS SUPPORT
   ============================================================================ */

@supports (-webkit-touch-callout: none) {
  .navbar,
  .sub-navbar,
  .whatsapp-popup-header {
    -webkit-backdrop-filter: blur(16px);
    backdrop-filter: blur(16px);
  }
}

